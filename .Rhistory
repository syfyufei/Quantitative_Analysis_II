stargazer(m1)
stargazer(m1)
summary(m1)
#--------1.5-----------
anova(m1, test="Chisq")
#---------1.6----------
PseudoR2(m1)
library(DescTools)
#---------1.6----------
PseudoR2(m1)
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * TRUE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * FALSE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1), labels=c("非党员", "党员"),
adj=0, xpd=NA)
# logLik()
attach(mydata)
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * TRUE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * FALSE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1), labels=c("非党员", "党员"),
adj=0, xpd=NA)
save.image(file = './fig/fig1.jpg' ,width = 8, height = 5, dpi = 100)
?save.image
# logLik()
jpeg(file = "fig1.jpg")
jpeg(p.picture, width=800 ,height = 500)
# logLik()
jpeg(file = "fig1.jpg")
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * TRUE + coef(m2)[4] * 1 + coef(m2)[8] * 1 * x), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * FALSE + coef(m2)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1 +
coef(m2)[8] *  c(0,1) * max(income)), labels=c("非党员", "党员"), adj=0, xpd=NA)
dev.off()
#--------1.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * TRUE + coef(m2)[4] * 1 + coef(m2)[8] * 1 * x), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * FALSE + coef(m2)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1 +
coef(m2)[8] *  c(0,1) * max(income)), labels=c("非党员", "党员"), adj=0, xpd=NA)
summary(m1)
summary(m2)
#---------1.6----------
PseudoR2(m2)
#--------1.5-----------
anova(m2, test="Chisq")
summary(m1)
invlogit(0.19)
invlogit(-0.19)
invlogit(-0.199659689807)
0.43/4
0.55/4
0.49/4
0.62/4
-1.01/4
summary(m2)
invlogit(-0.42)
0.47/4
0.49/4
0.55/4
0.62/4
mean(mydata$income)
mean(mydata$cpcer)
library(foreign)
library(DescTools)
library(dplyr)
library(lmtest)
library(BSDA)
library(stargazer)
options(scipen = 200, digits = 2)
data <- read.dta('./HW1/cgss2010_12.dta')
mydata <- data[,c('a49', 'a8a', 'a10','d12c')] %>%
na.omit()
mydata <- mydata[mydata$a10 != '拒绝回答缺失值' &
mydata$d12c != '拒绝回答' &
mydata$d12c != '不知道' &
mydata$a49 != '拒绝回答缺失值' &
mydata$a49 != '不知道缺失值', ]
mydata <- mydata %>% mutate( cpcer = ifelse(a10 == '共产党员', TRUE, FALSE)) %>%
mutate(protest = ifelse( d12c == '从未参与', FALSE, TRUE))
mydata <- mydata[, c('a8a', 'a49', 'cpcer', 'protest')]
names(mydata) <- c('income', 'nation_lan', 'cpcer', 'protest')
mydata$income <- as.numeric(mydata$income)
#-----------1.4---------
m1 <- glm(protest ~ income + cpcer + nation_lan,
family = binomial(link = "logit"), data = mydata)
m0 <- glm(protest ~ 1,
family = binomial(link = "logit"), data = mydata)
summary(m1)
stargazer(m1, type = 'text')
summary(m0)
coef(m1)
confint(m1)
exp(coef(m1))
exp(confint(m1))
#--------1.5-----------
anova(m1, test="Chisq")
#---------1.6----------
PseudoR2(m1)
#---------1.7----------
z.test(m1, sigma.x=0.5, conf.level=0.95)
#--------1.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
coef(m1)[3]
# logLik()
attach(mydata)
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * TRUE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * FALSE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1), labels=c("非党员", "党员"),
adj=0, xpd=NA)
save.image(file = './fig/fig1.jpg' ,width = 8, height = 5, dpi = 100)
#---------------interaction term----------
#-----------2.4---------
m2 <- glm(protest ~ income + cpcer + nation_lan + cpcer:income,
family = binomial(link = "logit"), data = mydata)
summary(m2)
#--------2.5-----------
anova(m2, test="Chisq")
#---------2.6----------
PseudoR2(m2)
#---------2.7----------
z.test(m2, sigma.x=0.5, conf.level=0.95)
#--------2.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * TRUE + coef(m2)[4] * 1 + coef(m2)[8] * 1 * x), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * FALSE + coef(m2)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1 +
coef(m2)[8] *  c(0,1) * max(income)), labels=c("非党员", "党员"), adj=0, xpd=NA)
library(foreign)
library(DescTools)
library(dplyr)
library(lmtest)
library(BSDA)
library(stargazer)
options(scipen = 200, digits = 2)
data <- read.dta('./HW1/cgss2010_12.dta')
mydata <- data[,c('a49', 'a8a', 'a10','d12c')] %>%
na.omit()
mydata <- mydata[mydata$a10 != '拒绝回答缺失值' &
mydata$d12c != '拒绝回答' &
mydata$d12c != '不知道' &
mydata$a49 != '拒绝回答缺失值' &
mydata$a49 != '不知道缺失值', ]
mydata <- mydata %>% mutate( cpcer = ifelse(a10 == '共产党员', TRUE, FALSE)) %>%
mutate(protest = ifelse( d12c == '从未参与', FALSE, TRUE))
mydata <- mydata[, c('a8a', 'a49', 'cpcer', 'protest')]
names(mydata) <- c('income', 'nation_lan', 'cpcer', 'protest')
mydata$income <- log(as.numeric(mydata$income)+1)
#-----------1.4---------
m1 <- glm(protest ~ income + cpcer + nation_lan,
family = binomial(link = "logit"), data = mydata)
m0 <- glm(protest ~ 1,
family = binomial(link = "logit"), data = mydata)
summary(m1)
stargazer(m1, type = 'text')
summary(m0)
coef(m1)
confint(m1)
exp(coef(m1))
exp(confint(m1))
#--------1.5-----------
anova(m1, test="Chisq")
#---------1.6----------
PseudoR2(m1)
#---------1.7----------
z.test(m1, sigma.x=0.5, conf.level=0.95)
#--------1.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
coef(m1)[3]
# logLik()
attach(mydata)
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * TRUE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * FALSE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1), labels=c("非党员", "党员"),
adj=0, xpd=NA)
save.image(file = './fig/fig1.jpg' ,width = 8, height = 5, dpi = 100)
# save.image(file = './fig/fig1.jpg' ,width = 8, height = 5, dpi = 100)
#---------------interaction term----------
#-----------2.4---------
m2 <- glm(protest ~ income + cpcer + nation_lan + cpcer:income,
family = binomial(link = "logit"), data = mydata)
summary(m2)
#--------2.5-----------
anova(m2, test="Chisq")
#---------2.6----------
PseudoR2(m2)
#---------2.7----------
z.test(m2, sigma.x=0.5, conf.level=0.95)
#--------2.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * TRUE + coef(m2)[4] * 1 + coef(m2)[8] * 1 * x), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * FALSE + coef(m2)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1 +
coef(m2)[8] *  c(0,1) * max(income)), labels=c("非党员", "党员"), adj=0, xpd=NA)
library(foreign)
library(DescTools)
library(dplyr)
library(lmtest)
library(BSDA)
library(stargazer)
options(scipen = 200, digits = 2)
data <- read.dta('./HW1/cgss2010_12.dta')
mydata <- data[,c('a49', 'a8a', 'a10','d12c')] %>%
na.omit()
mydata <- mydata[mydata$a10 != '拒绝回答缺失值' &
mydata$d12c != '拒绝回答' &
mydata$d12c != '不知道' &
mydata$a49 != '拒绝回答缺失值' &
mydata$a49 != '不知道缺失值', ]
mydata <- mydata %>% mutate( cpcer = ifelse(a10 == '共产党员', TRUE, FALSE)) %>%
mutate(protest = ifelse( d12c == '从未参与', FALSE, TRUE))
mydata <- mydata[, c('a8a', 'a49', 'cpcer', 'protest')]
names(mydata) <- c('income', 'nation_lan', 'cpcer', 'protest')
# mydata$income <- log(as.numeric(mydata$income)+1)
mydata$income <- as.numeric(mydata$income)
#-----------1.4---------
m1 <- glm(protest ~ income + cpcer + nation_lan,
family = binomial(link = "logit"), data = mydata)
m0 <- glm(protest ~ 1,
family = binomial(link = "logit"), data = mydata)
summary(m1)
stargazer(m1, type = 'text')
summary(m0)
coef(m1)
confint(m1)
exp(coef(m1))
exp(confint(m1))
#--------1.5-----------
anova(m1, test="Chisq")
#---------1.6----------
PseudoR2(m1)
#---------1.7----------
z.test(m1, sigma.x=0.5, conf.level=0.95)
#--------1.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
coef(m1)[3]
# logLik()
attach(mydata)
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * TRUE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=2)
View(m1)
coefci.default()
coefci.default()m1
coefci.default(m1)
library(foreign)
library(DescTools)
library(dplyr)
library(lmtest)
library(BSDA)
library(stargazer)
options(scipen = 200, digits = 2)
data <- read.dta('./HW1/cgss2010_12.dta')
mydata <- data[,c('a49', 'a8a', 'a10','d12c')] %>%
na.omit()
mydata <- mydata[mydata$a10 != '拒绝回答缺失值' &
mydata$d12c != '拒绝回答' &
mydata$d12c != '不知道' &
mydata$a49 != '拒绝回答缺失值' &
mydata$a49 != '不知道缺失值', ]
mydata <- mydata %>% mutate( cpcer = ifelse(a10 == '共产党员', TRUE, FALSE)) %>%
mutate(protest = ifelse( d12c == '从未参与', FALSE, TRUE))
mydata <- mydata[, c('a8a', 'a49', 'cpcer', 'protest')]
names(mydata) <- c('income', 'nation_lan', 'cpcer', 'protest')
# mydata$income <- log(as.numeric(mydata$income)+1)
mydata$income <- as.numeric(mydata$income)
#-----------1.4---------
m1 <- glm(protest ~ income + cpcer + nation_lan,
family = binomial(link = "logit"), data = mydata)
m0 <- glm(protest ~ 1,
family = binomial(link = "logit"), data = mydata)
summary(m1)
stargazer(m1, type = 'text')
summary(m0)
coef(m1)
confint(m1)
exp(coef(m1))
exp(confint(m1))
#--------1.5-----------
anova(m1, test="Chisq")
#---------1.6----------
PseudoR2(m1)
#---------1.7----------
z.test(m1, sigma.x=0.5, conf.level=0.95)
#--------1.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
coef(m1)[3]
# logLik()
attach(mydata)
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * TRUE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * FALSE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1), labels=c("非党员", "党员"),
adj=0, xpd=NA)
# save.image(file = './fig/fig1.jpg' ,width = 8, height = 5, dpi = 100)
#---------------interaction term----------
#-----------2.4---------
m2 <- glm(protest ~ income + cpcer + nation_lan + cpcer:income,
family = binomial(link = "logit"), data = mydata)
summary(m2)
#--------2.5-----------
anova(m2, test="Chisq")
#---------2.6----------
PseudoR2(m2)
#---------2.7----------
z.test(m2, sigma.x=0.5, conf.level=0.95)
#--------2.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * TRUE + coef(m2)[4] * 1 + coef(m2)[8] * 1 * x), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m2)[1] + coef(m2)[2] * x + coef(m2)[3] * FALSE + coef(m2)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1 +
coef(m2)[8] *  c(0,1) * max(income)), labels=c("非党员", "党员"), adj=0, xpd=NA)
library(foreign)
library(DescTools)
library(dplyr)
library(lmtest)
library(BSDA)
library(stargazer)
options(scipen = 200, digits = 2)
data <- read.dta('./HW1/cgss2010_12.dta')
mydata <- data[,c('a49', 'a8a', 'a10','d12c')] %>%
na.omit()
mydata <- mydata[mydata$a10 != '拒绝回答缺失值' &
mydata$d12c != '拒绝回答' &
mydata$d12c != '不知道' &
mydata$a49 != '拒绝回答缺失值' &
mydata$a49 != '不知道缺失值', ]
mydata <- mydata %>% mutate( cpcer = ifelse(a10 == '共产党员', TRUE, FALSE)) %>%
mutate(protest = ifelse( d12c == '从未参与', FALSE, TRUE))
mydata <- mydata[, c('a8a', 'a49', 'cpcer', 'protest')]
names(mydata) <- c('income', 'nation_lan', 'cpcer', 'protest')
# mydata$income <- log(as.numeric(mydata$income)+1)
mydata$income <- as.numeric(mydata$income)
#-----------1.4---------
m1 <- glm(protest ~ income + cpcer + nation_lan,
family = binomial(link = "logit"), data = mydata)
m0 <- glm(protest ~ 1,
family = binomial(link = "logit"), data = mydata)
summary(m1)
stargazer(m1, type = 'text')
summary(m0)
coef(m1)
confint(m1)
exp(coef(m1))
exp(confint(m1))
View(mydata)
#--------1.5-----------
anova(m1, test="Chisq")
#---------1.6----------
PseudoR2(m1)
#---------1.7----------
z.test(m1, sigma.x=0.5, conf.level=0.95)
#--------1.9-----------
invlogit<-function(x){
1/(1+exp(-x))
}
coef(m1)[3]
# logLik()
attach(mydata)
par(mar=c(3,3,3,2), mgp=c(1.5,0.2,0), tcl=-0.2)
plot(x = income, y = protest, type = 'n', xlab = 'income', ylab = 'protest', axes = FALSE,
frame.plot = TRUE, xlim = c (0,9999999), yaxs = 'i')
points(x = income,  y = jitter(as.numeric(protest), factor = 1.5), pch = '.')
axis(2, at=c(0,0.5,1))
axis(1)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * TRUE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=2)
curve(invlogit(coef(m1)[1] + coef(m1)[2] * x + coef(m1)[3] * FALSE + coef(m1)[4] * 1), from = min(income), to = max(income), add = TRUE, col=1)
text(x = max(income), y = invlogit( coef(m1)[1] + coef(m1)[2] * max(income) + coef(m1)[3] * c(0,1) + coef(m1)[4] * 1), labels=c("非党员", "党员"),
adj=0, xpd=NA)
library(foreign)
library(foreign)
data <- read.dta('./2sls.dta)
library(foreign)
data <- read.dta('./2sls.dta)
library(foreign)
data <- read.dta('./2sls.dta')
View(data)
data <- read.dta('./2sls.dta')
data <- 0
data <- read.dta('./2sls.dta')
m1 <- lm(y ~ x1 + x2 + x3, data = data)
,1
m1
library(stargazer)
library(foreign)
library(stargazer)
data <- read.dta('./2sls.dta')
library(foreign)
library(stargazer)
data <- read.dta('./2sls.dta')
stargazer(m1)
stargazer(m1, type = 'text')
library(foreign)
library(stargazer)
library(systemfit)
data <- read.dta('./2sls.dta')
eq1 <- y ~ x1 + x2 + x3
eq2 <- x3 ~ x1 + x2 + y
system <- list(eq1, eq2)
inst <- ~ x1 + x2 + z1 + z2
M2 <- systemfit(system, method="2SLS", inst=inst)
attach(data)
eq1 <- y ~ x1 + x2 + x3
eq2 <- x3 ~ x1 + x2 + y
system <- list(eq1, eq2)
inst <- ~ x1 + x2 + z1 + z2
M2 <- systemfit(system, method="2SLS", inst=inst)
summary(M2)
library(parallel)
parallel::detectCores()
bootFUN <- function(){
n <- nrow(data)
idx <- sample(1:n, n, replace=TRUE)
tmp <- as.data.frame(data[idx, ])
M1 <- lm(x3 ~ x1 + x2 + z1 + z2, data=tmp)
x3hat <- predict(M1)
M2 <- lm(y~x1+x2+x3hat, data=tmp)
return(coef(M2)["x3hat"])
}
# 1000 times
foo <- function() replicate(125, bootFUN())
cl <- makeCluster(parallel::detectCores())
clusterExport(cl = cl, c("data", "bootFUN")) # export object to each thread
tryCatch(res <- clusterCall(cl=cl, fun = foo), finally = stopCluster(cl))
sd(unlist(res))
abline(v = sd(unlist(res)), col = 1)
res
class(res)
unlist(res)
class(unlist(res))
class(res)
class(res)
hist(res)
hist(unlist(res)
)
